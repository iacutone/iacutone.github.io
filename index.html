
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Iacutone.rb</title>
  <meta name="author" content="">

  
  <meta name="description" content="In this post we will discuss how to turn nested JSON into Elm data types. This post uses a thin Elm.Http wrapper. Using this library helps us &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://iacutone.github.io">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Iacutone.rb" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Fjalla+One" rel="stylesheet" type="text/css">
<!--- MathJax Configuration -->
<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-38341110-1', 'auto');
    ga('send', 'pageview');

  </script>



</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Iacutone.rb</a></h1>
  
    <h2>coding and things</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscribe" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS" target="_blank"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewbox="0 0 100 100"><path class="social" d="M 13.310204,73.332654 C 5.967347,73.332654 0,79.322448 0,86.621428 c 0,7.338776 5.967347,13.262246 13.310204,13.262246 7.370408,0 13.328572,-5.92245 13.328572,-13.262246 0,-7.29898 -5.958164,-13.288774 -13.328572,-13.288774 z M 0.01530612,33.978572 V 53.143878 C 12.493878,53.143878 24.229592,58.02347 33.068368,66.865306 41.894898,75.685714 46.767346,87.47449 46.767346,100 h 19.25 C 66.017346,63.592858 36.4,33.979592 0.01530612,33.978572 l 0,0 z M 0.03877552,0 V 19.17449 C 44.54796,19.17551 80.77551,55.437756 80.77551,100 H 100 C 100,44.87653 55.15102,0 0.03877552,0 z"></path></svg></a></li>
  
</ul>
  
  
  
  
  
<ul class="subscribe">
  <li><a href="https://github.com/iacutone" rel="subscribe-github" title="@iacutone on GitHub" target="_blank"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewbox="0 0 100 100"><path class="social" d="M 50,0 C 22.385714,0 0,22.385714 0,50 0,77.614286 22.385714,100 50,100 77.614286,100 100,77.614286 100,50 100,22.385714 77.614286,0 50,0 z m 29.692858,79.692858 c -3.859184,3.859182 -8.351022,6.887754 -13.35,9.00306 -1.27041,0.536736 -2.560204,1.009184 -3.867348,1.415306 v -7.493878 c 0,-3.938774 -1.35102,-6.835714 -4.053062,-8.690816 1.692858,-0.163264 3.24694,-0.390816 4.663266,-0.683672 1.416326,-0.292858 2.913266,-0.716328 4.491838,-1.27041 1.57857,-0.55408 2.994896,-1.213264 4.247958,-1.97755 1.253062,-0.765306 2.458164,-1.758164 3.613266,-2.978572 1.155102,-1.220408 2.12449,-2.604082 2.905102,-4.15 0.780612,-1.545918 1.4,-3.40204 1.855102,-5.566326 0.455102,-2.164286 0.683674,-4.54898 0.683674,-7.153062 0,-5.045918 -1.643878,-9.341836 -4.931634,-12.890816 C 77.44796,33.35 77.285714,29.10204 75.463266,24.512244 l -1.22143,-0.145918 c -0.845918,-0.09796 -2.368366,0.260204 -4.565306,1.07449 -2.196938,0.814286 -4.663264,2.14796 -7.396938,4.004082 -3.87449,-1.07449 -7.893878,-1.611224 -12.061224,-1.611224 -4.19898,0 -8.203062,0.536734 -12.012246,1.611224 -1.72449,-1.17245 -3.361224,-2.139796 -4.907142,-2.905102 C 31.753062,25.77449 30.516326,25.254082 29.587756,24.97653 28.660204,24.7 27.79796,24.528572 27,24.463266 c -0.79796,-0.0653 -1.310204,-0.08062 -1.537756,-0.04898 -0.22755,0.03164 -0.390816,0.0653 -0.487754,0.09796 -1.82347,4.62245 -1.985714,8.87143 -0.487756,12.743878 -3.287754,3.54796 -4.931632,7.844898 -4.931632,12.890816 0,2.604082 0.227552,4.988776 0.683674,7.153062 0.456122,2.164286 1.07449,4.020408 1.855102,5.566326 0.780612,1.545918 1.75,2.929592 2.905102,4.15 1.155102,1.220408 2.360204,2.213266 3.613264,2.978572 1.253062,0.766326 2.669388,1.42449 4.24796,1.97755 1.578572,0.554082 3.07551,0.976532 4.491836,1.27041 1.416328,0.292856 2.970408,0.521428 4.663266,0.683672 -2.669388,1.82347 -4.004082,4.720408 -4.004082,8.690816 v 7.639796 C 36.536734,89.818368 35.083674,89.3 33.656122,88.695918 c -4.99898,-2.115306 -9.490816,-5.143878 -13.35,-9.00306 -3.859184,-3.859184 -6.887754,-8.351022 -9.00306,-13.35 C 9.1163263,61.171428 8.0071428,55.67347 8.0071428,50 c 0,-5.67347 1.1091835,-11.171428 3.2969392,-16.342858 2.115306,-4.998978 5.143878,-9.490816 9.00306,-13.35 3.859184,-3.859182 8.351022,-6.887754 13.35,-9.00306 C 38.828572,9.1163266 44.32653,8.0071428 50,8.0071428 c 5.67347,0 11.171428,1.1091838 16.342858,3.2969392 5,2.115306 9.490816,5.143878 13.35,9.00306 3.859182,3.859184 6.887754,8.351022 9.00306,13.35 2.186736,5.17245 3.295918,10.67041 3.295918,16.342858 0,5.672448 -1.109182,11.171428 -3.296938,16.342858 -2.115306,4.998978 -5.143878,9.490816 -9.00204,13.35 l 0,0 z"></path></svg></a></li>
</ul>
  
  
  
<ul class="subscribe">
  <li><a href="https://twitter.com/iacutone" rel="subscribe-twitter" title="@iacutone on Twitter" target="_blank"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewBox="0 0 512 512"><path class="social" d="M0.001,334.932c33.327,30.816,118.891,59.981,188.517-8.271c-12.52,1.955-22.972-0.416-30.913-8.269
  c-7.531-7.465-7.945-15.182-3.914-22.202c3.275-5.725,10.184-9.741,16.977-13.934c-12.323,2.285-22.829,1.095-32.218-3.706
  c-12.604-6.444-24.863-13.228-28.3-27.207c7.71-8.112,16.28-15.359,34.831-12.627c-17.45-5.83-33.087-13.429-44.41-24.815
  c-11.028-11.091-12.163-18.302-13.932-26.996c9.632-3.567,19.688-5.421,30.478-4.353c-24.397-12.476-34.757-29.63-40.487-48.325
  c-1.731-5.652-2.044-11.03-1.31-16.545c98.826,37.305,145.11,64.109,170.662,89.251c11.496-30.589,38.3-99.868,78.371-123.646
  c0.191,3.77-1.309,7.837-4.357,12.189c11.863-6.609,21.125-17.188,37.445-16.98c-1.879,7.723-7.279,13.904-17.85,17.854
  c10.662-4.084,21.463-7.545,32.65-9.578c10.375-1.881,10.229,6.304,4.355,10.444c-11.916,8.412-24.578,9.456-37.006,13.498
  c38.105,0.949,69.266,18.994,93.604,58.343c8.088,13.074,13.52,26.149,14.807,40.487c16.254,4.563,32.426,5.494,48.76,2.61
  c4.475-0.796,8.645-1.63,12.627-3.482c-6.354,9.529-13.686,17.356-23.947,20.899c-9.811,3.387-19.637,6.688-30.473,6.968
  c17.641,6.675,37.082,7.045,57.033,5.659c-24.402,23.486-43.08,22.922-61.824,22.642c-8.221,34.703-25.025,69.315-60.52,101.005
  c-46.559,41.569-96.678,61.397-148.457,65.742c-48.552,4.07-95.488,3.512-146.726-20.464
  C56.486,393.349,24.648,368.884,0.001,334.932L0.001,334.932z"/></svg></a></li>
</ul>
  
  
  
  
  
  
    
      <form action="https://www.google.com/search" method="get">
        <fieldset role="search">
          <input type="hidden" name="sitesearch" value="iacutone.github.io" />
    
          <input class="search" type="text" name="q" results="0" placeholder="Search"/>
        </fieldset>
      </form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2018/04/25/graphql-with-elm-part-2/">GraphQL With Elm Part 2, Parsing Nested JSON</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2018-04-25T14:17:04-05:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2018</span></span> <span class='time'>2:17 pm</span></time>
        
         | <a href="/blog/2018/04/25/graphql-with-elm-part-2/#disqus_thread">Comments</a>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p>In this post we will discuss how to turn nested JSON into Elm data types. This post uses a thin <code>Elm.Http</code> <a href="https://github.com/NoRedInk/elm-decode-pipeline">wrapper</a>. Using this library helps us concentrate on contructing the necessary Decoders. We will also contruct a more complex query in order to explain how to contruct complex data types. The following query returns JSON for the first two team members of FracturedAtlas.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='haskell'><span class='line'><span class="nf">query</span> <span class="kt">:</span> <span class="kt">String</span>
</span><span class='line'><span class="nf">query</span> <span class="ow">=</span>
</span><span class='line'>    <span class="s">&quot;&quot;&quot;</span>
</span><span class='line'><span class="s">    query {</span>
</span><span class='line'><span class="s">      organization(login: &quot;</span><span class="kt">FracturedAtlas</span><span class="s">&quot;) {</span>
</span><span class='line'><span class="s">        team(slug: &quot;</span><span class="n">fa</span><span class="o">-</span><span class="n">dev</span><span class="s">&quot;) {</span>
</span><span class='line'><span class="s">          members(first:2) {</span>
</span><span class='line'><span class="s">            edges {</span>
</span><span class='line'><span class="s">              node {</span>
</span><span class='line'><span class="s">                id</span>
</span><span class='line'><span class="s">                login</span>
</span><span class='line'><span class="s">              }</span>
</span><span class='line'><span class="s">            }</span>
</span><span class='line'><span class="s">          }</span>
</span><span class='line'><span class="s">        }</span>
</span><span class='line'><span class="s">      }</span>
</span><span class='line'><span class="s">    }</span>
</span><span class='line'><span class="s">    &quot;&quot;&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Swapping out our query will return the following JSON.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="p">{</span><span class="nt">&quot;data&quot;</span><span class="p">:{</span><span class="nt">&quot;organization&quot;</span><span class="p">:{</span><span class="nt">&quot;team&quot;</span><span class="p">:{</span><span class="nt">&quot;members&quot;</span><span class="p">:{</span><span class="nt">&quot;edges&quot;</span><span class="p">:[{</span><span class="nt">&quot;node&quot;</span><span class="p">:{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;user id&gt;&quot;</span><span class="p">,</span><span class="nt">&quot;login&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;user name&gt;&quot;</span><span class="p">}},{</span><span class="nt">&quot;node&quot;</span><span class="p">:{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;another user id&gt;&quot;</span><span class="p">,</span><span class="nt">&quot;login&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;user name&gt;&quot;</span><span class="p">}}]}}}}}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The following part took me a long time to grok. The issues I had difficulty resolving are:
1. How do I grab the list of nodes?
1. How to I change my stringified JSON output into Elm data types?</p>

<p>The rest of this post tackles these two issues.</p>

<p>The <code>requiredAt</code> function from Elm Decode Pipeline solves the first problem.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='haskell'><span class='line'><span class="nf">decodeLogin</span> <span class="ow">=</span>
</span><span class='line'>    <span class="n">decode</span> <span class="kt">Users</span>
</span><span class='line'>            <span class="o">|&gt;</span> <span class="n">requiredAt</span> <span class="p">[</span><span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="s">&quot;organization&quot;</span><span class="p">,</span> <span class="s">&quot;team&quot;</span><span class="p">,</span> <span class="s">&quot;members&quot;</span><span class="p">,</span> <span class="s">&quot;edges&quot;</span><span class="p">]</span> <span class="p">(</span><span class="kt">Json</span><span class="o">.</span><span class="kt">Decode</span><span class="o">.</span><span class="n">list</span> <span class="n">decodeNode</span><span class="p">)</span>
</span><span class='line'>      <span class="c1">-- &#39;dig&#39; into the JSON and extract the node list</span>
</span><span class='line'>
</span><span class='line'><span class="nf">decodeNode</span> <span class="ow">=</span>
</span><span class='line'>    <span class="n">decode</span> <span class="kt">Node</span>
</span><span class='line'>        <span class="o">|&gt;</span> <span class="n">required</span> <span class="s">&quot;node&quot;</span> <span class="n">decodeUser</span>
</span><span class='line'>
</span><span class='line'><span class="nf">decodeUser</span> <span class="ow">=</span>
</span><span class='line'>    <span class="n">decode</span> <span class="kt">User</span>
</span><span class='line'>        <span class="o">|&gt;</span> <span class="n">required</span> <span class="s">&quot;id&quot;</span> <span class="n">string</span>
</span><span class='line'>        <span class="o">|&gt;</span> <span class="n">required</span> <span class="s">&quot;login&quot;</span> <span class="n">string</span>
</span></code></pre></td></tr></table></div></figure>


<p>Let&rsquo;s construct our Elm datatypes based on the JSON response.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='haskell'><span class='line'><span class="kr">type</span> <span class="n">alias</span> <span class="kt">Model</span> <span class="ow">=</span>
</span><span class='line'>    <span class="p">{</span> <span class="n">message</span> <span class="kt">:</span> <span class="kt">String</span>
</span><span class='line'>    <span class="p">,</span> <span class="n">users</span> <span class="kt">:</span> <span class="kt">Maybe</span> <span class="kt">Users</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kr">type</span> <span class="n">alias</span> <span class="kt">Users</span> <span class="ow">=</span>
</span><span class='line'>    <span class="p">{</span> <span class="n">edges</span> <span class="kt">:</span> <span class="kt">List</span> <span class="kt">Node</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kr">type</span> <span class="n">alias</span> <span class="kt">Node</span> <span class="ow">=</span>
</span><span class='line'>    <span class="p">{</span> <span class="n">node</span><span class="kt">:</span> <span class="kt">User</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kr">type</span> <span class="n">alias</span> <span class="kt">User</span> <span class="ow">=</span>
</span><span class='line'>    <span class="p">{</span> <span class="n">id</span><span class="kt">:</span>  <span class="kt">String</span>
</span><span class='line'>    <span class="p">,</span> <span class="n">login</span> <span class="kt">:</span> <span class="kt">String</span>
</span><span class='line'>    <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now to handle the update function.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='haskell'><span class='line'><span class="nf">update</span> <span class="kt">:</span> <span class="kt">Msg</span> <span class="ow">-&gt;</span> <span class="kt">Model</span> <span class="ow">-&gt;</span> <span class="p">(</span> <span class="kt">Model</span><span class="p">,</span> <span class="kt">Cmd</span> <span class="kt">Msg</span> <span class="p">)</span>
</span><span class='line'><span class="nf">update</span> <span class="n">msg</span> <span class="n">model</span> <span class="ow">=</span>
</span><span class='line'>    <span class="kr">case</span> <span class="n">msg</span> <span class="kr">of</span>
</span><span class='line'>        <span class="kt">GraphQLQuery</span> <span class="p">(</span><span class="kt">Ok</span> <span class="n">res</span><span class="p">)</span> <span class="ow">-&gt;</span>
</span><span class='line'>            <span class="kr">case</span> <span class="n">decodeString</span> <span class="n">decodeLogin</span> <span class="n">res</span> <span class="kr">of</span>
</span><span class='line'>                <span class="kt">Ok</span> <span class="n">res</span> <span class="ow">-&gt;</span>
</span><span class='line'>                    <span class="p">(</span> <span class="p">{</span> <span class="n">model</span> <span class="o">|</span> <span class="n">users</span> <span class="ow">=</span> <span class="kt">Just</span> <span class="n">res</span> <span class="p">},</span> <span class="kt">Cmd</span><span class="o">.</span><span class="n">none</span> <span class="p">)</span>
</span><span class='line'>                <span class="kt">Err</span> <span class="ne">error</span> <span class="ow">-&gt;</span>
</span><span class='line'>                    <span class="p">(</span> <span class="p">{</span> <span class="n">model</span> <span class="o">|</span> <span class="n">message</span> <span class="ow">=</span> <span class="ne">error</span><span class="p">,</span> <span class="n">users</span> <span class="ow">=</span> <span class="kt">Nothing</span> <span class="p">},</span> <span class="kt">Cmd</span><span class="o">.</span><span class="n">none</span> <span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="kt">GraphQLQuery</span> <span class="p">(</span><span class="kt">Err</span> <span class="n">res</span><span class="p">)</span> <span class="ow">-&gt;</span>
</span><span class='line'>            <span class="p">(</span> <span class="p">{</span> <span class="n">model</span> <span class="o">|</span> <span class="n">users</span> <span class="ow">=</span> <span class="kt">Nothing</span> <span class="p">},</span> <span class="kt">Cmd</span><span class="o">.</span><span class="n">none</span> <span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>I spent numerous hours figuring out how to map the Elm data types to the decoders. In Part 3, we will learn how to display the <code>User</code> data type in the browser.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2018/04/23/graphql-with-elm-part-1-communicating-with-github/">GraphQL With Elm Part 1, Communicating With GitHub</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2018-04-23T10:40:40-05:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2018</span></span> <span class='time'>10:40 am</span></time>
        
         | <a href="/blog/2018/04/23/graphql-with-elm-part-1-communicating-with-github/#disqus_thread">Comments</a>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p>A co-worker and are using GitHub&rsquo;s GraphQL API for a side project. I am writing a series of posts around what we learned from creating the application entitled &lsquo;GraghQL and Elm&rsquo;. This post will detail how to communicate with the Github GraphQL API with Elm. All code related to these posts can be found <a href="https://github.com/iacutone/github-elm">here</a>.</p>

<p>GitHub has extensive <a href="https://developer.github.com/v4/">documentation</a> on communicating with their GraphQL server. In this post we will write a simple query and display the JSON from Github. In the next post, we will use Elm Decoders in order to turn the JSON into Elm data.</p>

<p>The <a href="https://developer.github.com/v4/explorer/">GitHub GraphQL Explorer</a> is useful for crafting queries. Let&rsquo;s write a query that fetches a user&rsquo;s id:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="err">user(login:</span><span class="nt">&quot;iacutone&quot;</span><span class="err">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="err">id</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>With the aforementioned JSON, let&rsquo;s contruct a request to GitHub in Elm!</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='haskell'><span class='line'><span class="nf">query</span> <span class="kt">:</span> <span class="kt">String</span>
</span><span class='line'><span class="nf">query</span> <span class="ow">=</span>
</span><span class='line'>    <span class="s">&quot;&quot;&quot;</span>
</span><span class='line'><span class="s">    query {</span>
</span><span class='line'><span class="s">      {</span>
</span><span class='line'><span class="s">        user(login:&quot;</span><span class="n">iacutone</span><span class="s">&quot;) {</span>
</span><span class='line'><span class="s">          id</span>
</span><span class='line'><span class="s">        }</span>
</span><span class='line'><span class="s">      }</span>
</span><span class='line'><span class="s">    }</span>
</span><span class='line'><span class="s">    &quot;&quot;&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="nf">baseUrl</span> <span class="kt">:</span> <span class="kt">String</span>
</span><span class='line'><span class="nf">baseUrl</span> <span class="ow">=</span>
</span><span class='line'>    <span class="s">&quot;https://api.github.com/graphql&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="nf">bearerToken</span> <span class="kt">:</span> <span class="kt">String</span>
</span><span class='line'><span class="nf">bearerToken</span> <span class="ow">=</span>
</span><span class='line'>    <span class="s">&quot;Bearer &lt;your GitHub token here&gt;&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="nf">request</span> <span class="kt">:</span> <span class="kt">Http</span><span class="o">.</span><span class="kt">Request</span> <span class="kt">String</span>
</span><span class='line'><span class="nf">request</span> <span class="ow">=</span>
</span><span class='line'>    <span class="kt">Http</span><span class="o">.</span><span class="n">request</span>
</span><span class='line'>  <span class="p">{</span> <span class="n">method</span> <span class="ow">=</span> <span class="s">&quot;POST&quot;</span>
</span><span class='line'>  <span class="p">,</span> <span class="n">headers</span> <span class="ow">=</span> <span class="p">[</span><span class="kt">Http</span><span class="o">.</span><span class="n">header</span> <span class="s">&quot;Authorization&quot;</span> <span class="n">bearerToken</span><span class="p">]</span>
</span><span class='line'>  <span class="p">,</span> <span class="n">url</span> <span class="ow">=</span> <span class="n">baseUrl</span>
</span><span class='line'>  <span class="p">,</span> <span class="n">body</span> <span class="ow">=</span> <span class="kt">Http</span><span class="o">.</span><span class="n">jsonBody</span> <span class="p">(</span><span class="kt">Encode</span><span class="o">.</span><span class="n">object</span> <span class="p">[(</span><span class="s">&quot;query&quot;</span><span class="p">,</span> <span class="kt">Encode</span><span class="o">.</span><span class="n">string</span> <span class="n">query</span><span class="p">)])</span>
</span><span class='line'>  <span class="p">,</span> <span class="n">expect</span> <span class="ow">=</span> <span class="kt">Http</span><span class="o">.</span><span class="n">expectString</span>
</span><span class='line'>  <span class="p">,</span> <span class="n">timeout</span> <span class="ow">=</span> <span class="kt">Nothing</span>
</span><span class='line'>  <span class="p">,</span> <span class="n">withCredentials</span> <span class="ow">=</span> <span class="kt">False</span>
</span><span class='line'>  <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>After posting the query to GitHub, your Elm update function will receive the following response:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nt">&quot;user&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>      <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;MDQ6VXNlcjE1NjMyMDE=&quot;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>I find it helpful to define this response as an Elm <code>String</code> type and view it in the browser. If there is an error with the query, you can see the results in the browser.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
</pre></td><td class='code'><pre><code class='haskell'><span class='line'><span class="c1">-- MODEL</span>
</span><span class='line'>
</span><span class='line'><span class="kr">type</span> <span class="n">alias</span> <span class="kt">Model</span> <span class="ow">=</span>
</span><span class='line'>    <span class="p">{</span> <span class="n">response</span> <span class="kt">:</span> <span class="kt">String</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">-- UPDATE</span>
</span><span class='line'>
</span><span class='line'><span class="kr">type</span> <span class="kt">Msg</span>
</span><span class='line'>    <span class="ow">=</span> <span class="kt">GraphQLQuery</span> <span class="p">(</span><span class="kt">Result</span> <span class="kt">Http</span><span class="o">.</span><span class="kt">Error</span> <span class="kt">String</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nf">update</span> <span class="kt">:</span> <span class="kt">Msg</span> <span class="ow">-&gt;</span> <span class="kt">Model</span> <span class="ow">-&gt;</span> <span class="p">(</span> <span class="kt">Model</span><span class="p">,</span> <span class="kt">Cmd</span> <span class="kt">Msg</span> <span class="p">)</span>
</span><span class='line'><span class="nf">update</span> <span class="n">msg</span> <span class="n">model</span> <span class="ow">=</span>
</span><span class='line'>    <span class="kr">case</span> <span class="n">msg</span> <span class="kr">of</span>
</span><span class='line'>        <span class="kt">GraphQLQuery</span> <span class="p">(</span><span class="kt">Ok</span> <span class="n">res</span><span class="p">)</span> <span class="ow">-&gt;</span>
</span><span class='line'>            <span class="p">(</span> <span class="p">{</span> <span class="n">model</span> <span class="o">|</span> <span class="n">response</span> <span class="ow">=</span> <span class="n">res</span> <span class="p">},</span> <span class="kt">Cmd</span><span class="o">.</span><span class="n">none</span> <span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="kt">GraphQLQuery</span> <span class="p">(</span><span class="kt">Err</span> <span class="n">res</span><span class="p">)</span> <span class="ow">-&gt;</span>
</span><span class='line'>            <span class="p">(</span> <span class="p">{</span> <span class="n">model</span> <span class="o">|</span> <span class="n">response</span> <span class="ow">=</span> <span class="n">toString</span> <span class="n">res</span> <span class="p">},</span> <span class="kt">Cmd</span><span class="o">.</span><span class="n">none</span> <span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nf">initialModel</span> <span class="kt">:</span> <span class="kt">Model</span>
</span><span class='line'><span class="nf">initialModel</span> <span class="ow">=</span>
</span><span class='line'>    <span class="p">{</span> <span class="n">response</span> <span class="ow">=</span> <span class="s">&quot;&quot;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nf">init</span> <span class="kt">:</span> <span class="p">(</span><span class="kt">Model</span><span class="p">,</span> <span class="kt">Cmd</span> <span class="kt">Msg</span><span class="p">)</span>
</span><span class='line'><span class="nf">init</span> <span class="ow">=</span>
</span><span class='line'>    <span class="p">(</span> <span class="n">initialModel</span><span class="p">,</span> <span class="kt">Http</span><span class="o">.</span><span class="n">send</span> <span class="kt">GraphQLQuery</span> <span class="n">request</span> <span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nf">main</span> <span class="kt">:</span> <span class="kt">Program</span> <span class="kt">Never</span> <span class="kt">Model</span> <span class="kt">Msg</span>
</span><span class='line'><span class="nf">main</span> <span class="ow">=</span>
</span><span class='line'>    <span class="kt">Html</span><span class="o">.</span><span class="n">program</span>
</span><span class='line'>        <span class="p">{</span> <span class="n">init</span> <span class="ow">=</span> <span class="n">init</span>
</span><span class='line'>        <span class="p">,</span> <span class="n">view</span> <span class="ow">=</span> <span class="n">view</span>
</span><span class='line'>        <span class="p">,</span> <span class="n">update</span> <span class="ow">=</span> <span class="n">update</span>
</span><span class='line'>        <span class="p">,</span> <span class="n">subscriptions</span> <span class="ow">=</span> <span class="nf">\</span><span class="kr">_</span> <span class="ow">-&gt;</span> <span class="kt">Sub</span><span class="o">.</span><span class="n">none</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">-- VIEW</span>
</span><span class='line'>
</span><span class='line'><span class="nf">view</span> <span class="kt">:</span> <span class="kt">Model</span> <span class="ow">-&gt;</span> <span class="kt">Html</span> <span class="kt">Msg</span>
</span><span class='line'><span class="nf">view</span> <span class="n">model</span> <span class="ow">=</span>
</span><span class='line'>    <span class="n">div</span> <span class="kt">[]</span> <span class="p">[</span> <span class="n">text</span> <span class="n">model</span><span class="o">.</span><span class="n">response</span> <span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>The code above will display a stringfied version of our query. In Part 2, we will transform the Elm <code>String</code> data object into something more useful with Elm decoders.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2018/04/16/understanding-union-types-in-elm/">Understanding Union Types in Elm</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2018-04-16T18:19:13-05:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>16</span><span class='date-suffix'>th</span>, <span class='date-year'>2018</span></span> <span class='time'>6:19 pm</span></time>
        
         | <a href="/blog/2018/04/16/understanding-union-types-in-elm/#disqus_thread">Comments</a>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p>Watching <a href="https://www.youtube.com/watch?v=IcgmSRJHu_8">Making Impossible States Impossible</a> and reading <a href="https://becoming-functional.com/higher-level-coding-with-elm-union-types-2502d1f5a615">Higher Level Coding with Elm Union Types</a> were enlightening in my Elm development. Now, I look for places were I can refine my data model by using union types. Union types allow me to replace conditionals with pattern matching case statements. This pattern is much cleaner and easier to understand. The following is an example of how I used union types to refactor a hamburger.</p>

<h2>Elm Model</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='haskell'><span class='line'><span class="c1">-- BEFORE</span>
</span><span class='line'>
</span><span class='line'><span class="kr">type</span> <span class="kt">Msg</span>
</span><span class='line'>    <span class="ow">=</span> <span class="kt">DisplayHamburgerItems</span>
</span><span class='line'>
</span><span class='line'><span class="kr">type</span> <span class="n">alias</span> <span class="kt">Model</span> <span class="ow">=</span>
</span><span class='line'>    <span class="p">{</span> <span class="n">hamburger_open</span> <span class="kt">:</span> <span class="kt">Bool</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">-- AFTER</span>
</span><span class='line'>
</span><span class='line'><span class="kr">type</span> <span class="kt">Msg</span>
</span><span class='line'>    <span class="ow">=</span> <span class="kt">DisplayHamburgerItems</span> <span class="kt">Hamburger</span>
</span><span class='line'>
</span><span class='line'><span class="kr">type</span> <span class="kt">Hamburger</span>
</span><span class='line'>    <span class="ow">=</span> <span class="kt">Open</span>
</span><span class='line'>    <span class="o">|</span> <span class="kt">Closed</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="kr">type</span> <span class="n">alias</span> <span class="kt">Model</span> <span class="ow">=</span>
</span><span class='line'>    <span class="p">{</span> <span class="n">hamburger</span> <span class="kt">:</span> <span class="kt">Hamburger</span>
</span><span class='line'>    <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Elm Update</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='haskell'><span class='line'><span class="nf">update</span> <span class="kt">:</span> <span class="kt">Msg</span> <span class="ow">-&gt;</span> <span class="kt">Model</span> <span class="ow">-&gt;</span> <span class="p">(</span> <span class="kt">Model</span><span class="p">,</span> <span class="kt">Cmd</span> <span class="kt">Msg</span> <span class="p">)</span>
</span><span class='line'><span class="nf">update</span> <span class="n">msg</span> <span class="n">model</span> <span class="ow">=</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">-- BEFORE</span>
</span><span class='line'>
</span><span class='line'>    <span class="kr">case</span> <span class="n">msg</span> <span class="kr">of</span>
</span><span class='line'>        <span class="kt">DisplayHamburgerItems</span> <span class="ow">-&gt;</span>
</span><span class='line'>            <span class="kr">if</span> <span class="n">model</span><span class="o">.</span><span class="n">hamburger_open</span> <span class="o">==</span> <span class="kt">True</span> <span class="kr">then</span>
</span><span class='line'>                <span class="kr">let</span>
</span><span class='line'>                    <span class="n">items</span> <span class="ow">=</span> <span class="kt">List</span><span class="o">.</span><span class="n">append</span> <span class="n">model</span><span class="o">.</span><span class="n">display_hamburger</span> <span class="p">[</span><span class="s">&quot;About&quot;</span><span class="p">,</span> <span class="s">&quot;Contact&quot;</span><span class="p">,</span> <span class="s">&quot;Menu&quot;</span><span class="p">]</span>
</span><span class='line'>                <span class="kr">in</span>
</span><span class='line'>                    <span class="p">(</span> <span class="p">{</span> <span class="n">model</span> <span class="o">|</span> <span class="n">display_hamburger</span> <span class="ow">=</span> <span class="n">items</span><span class="p">,</span> <span class="n">hamburger_open</span> <span class="ow">=</span> <span class="kt">False</span> <span class="p">},</span> <span class="kt">Cmd</span><span class="o">.</span><span class="n">none</span> <span class="p">)</span>
</span><span class='line'>            <span class="kr">else</span>
</span><span class='line'>                <span class="p">(</span> <span class="p">{</span> <span class="n">model</span> <span class="o">|</span> <span class="n">display_hamburger</span> <span class="ow">=</span> <span class="kt">[]</span><span class="p">,</span> <span class="n">hamburger_open</span> <span class="ow">=</span> <span class="kt">True</span> <span class="p">},</span> <span class="kt">Cmd</span><span class="o">.</span><span class="n">none</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="c1">-- AFTER</span>
</span><span class='line'>
</span><span class='line'>        <span class="kt">DisplayHamburgerItems</span> <span class="n">msg</span> <span class="ow">-&gt;</span>
</span><span class='line'>            <span class="kr">case</span> <span class="n">msg</span> <span class="kr">of</span>
</span><span class='line'>                <span class="kt">Open</span> <span class="ow">-&gt;</span>
</span><span class='line'>                    <span class="kr">let</span>
</span><span class='line'>                        <span class="n">items</span> <span class="ow">=</span> <span class="kt">List</span><span class="o">.</span><span class="n">append</span> <span class="n">model</span><span class="o">.</span><span class="n">display_hamburger</span> <span class="p">[</span><span class="s">&quot;About&quot;</span><span class="p">,</span> <span class="s">&quot;Contact&quot;</span><span class="p">,</span> <span class="s">&quot;Menu&quot;</span><span class="p">]</span>
</span><span class='line'>                    <span class="kr">in</span>
</span><span class='line'>                        <span class="p">(</span> <span class="p">{</span> <span class="n">model</span> <span class="o">|</span> <span class="n">hamburger</span> <span class="ow">=</span> <span class="kt">Open</span><span class="p">,</span> <span class="n">display_hamburger</span> <span class="ow">=</span> <span class="n">items</span> <span class="p">},</span> <span class="kt">Cmd</span><span class="o">.</span><span class="n">none</span> <span class="p">)</span>
</span><span class='line'>                <span class="kt">Closed</span> <span class="ow">-&gt;</span>
</span><span class='line'>                    <span class="p">(</span> <span class="p">{</span> <span class="n">model</span> <span class="o">|</span> <span class="n">hamburger</span> <span class="ow">=</span>  <span class="kt">Closed</span><span class="p">,</span> <span class="n">display_hamburger</span> <span class="ow">=</span> <span class="kt">[]</span> <span class="p">},</span> <span class="kt">Cmd</span><span class="o">.</span><span class="n">none</span> <span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Elm View</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='haskell'><span class='line'><span class="nf">view</span> <span class="kt">:</span> <span class="kt">Model</span> <span class="ow">-&gt;</span> <span class="kt">Html</span> <span class="kt">Msg</span>
</span><span class='line'><span class="nf">view</span> <span class="n">model</span> <span class="ow">=</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">-- BEFORE</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">i</span> <span class="p">[</span> <span class="n">onClick</span> <span class="p">(</span><span class="kt">DisplayHamburgerItems</span><span class="p">)</span> <span class="p">]</span> <span class="kt">[]</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">-- AFTER</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">i</span> <span class="p">[</span> <span class="n">onClick</span> <span class="p">(</span><span class="kt">DisplayHamburgerItems</span> <span class="p">(</span><span class="n">toggleHamburger</span> <span class="n">model</span><span class="o">.</span><span class="n">hamburger</span><span class="p">))</span> <span class="p">]</span> <span class="kt">[]</span>
</span><span class='line'>
</span><span class='line'><span class="nf">viewHamburgerItems</span> <span class="kt">:</span> <span class="kt">Model</span> <span class="ow">-&gt;</span> <span class="kt">Html</span> <span class="kt">Msg</span>
</span><span class='line'><span class="nf">viewHamburgerItems</span> <span class="n">model</span> <span class="ow">=</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">-- BEFORE</span>
</span><span class='line'>
</span><span class='line'>    <span class="kr">if</span> <span class="n">model</span><span class="o">.</span><span class="n">hamburger_open</span> <span class="o">==</span> <span class="kt">False</span> <span class="kr">then</span>
</span><span class='line'>        <span class="n">div</span> <span class="kt">[]</span> <span class="p">(</span><span class="kt">List</span><span class="o">.</span><span class="n">map</span> <span class="n">item</span> <span class="n">model</span><span class="o">.</span><span class="n">display_hamburger</span><span class="p">)</span>
</span><span class='line'>    <span class="kr">else</span>
</span><span class='line'>        <span class="n">div</span> <span class="kt">[]</span> <span class="kt">[]</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">-- AFTER</span>
</span><span class='line'>
</span><span class='line'>    <span class="kr">case</span> <span class="n">model</span><span class="o">.</span><span class="n">hamburger</span> <span class="kr">of</span>
</span><span class='line'>        <span class="kt">Open</span> <span class="ow">-&gt;</span>
</span><span class='line'>            <span class="n">div</span> <span class="kt">[]</span> <span class="p">(</span><span class="kt">List</span><span class="o">.</span><span class="n">map</span> <span class="n">item</span> <span class="n">model</span><span class="o">.</span><span class="n">display_hamburger</span><span class="p">)</span>
</span><span class='line'>        <span class="kt">Closed</span> <span class="ow">-&gt;</span>
</span><span class='line'>            <span class="n">div</span> <span class="kt">[]</span> <span class="kt">[]</span>
</span></code></pre></td></tr></table></div></figure>


<p>It is easier to reason about <code>Hamburger</code> with <code>Open</code> and <code>Closed</code> types than checking against a <code>Bool</code>. Pattern matching on the union type is expressive and is really helpful when the union types grow in complexity.</p>

<p>Full code <a href="https://github.com/iacutone/menus">here</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2018/01/10/pr-review-diagram/">PR Review Diagram</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2018-01-10T11:59:11-05:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>10</span><span class='date-suffix'>th</span>, <span class='date-year'>2018</span></span> <span class='time'>11:59 am</span></time>
        
         | <a href="/blog/2018/01/10/pr-review-diagram/#disqus_thread">Comments</a>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p>I thought I would share my diagram for how I think about PR review. The following diagram received good reception from my team.</p>

<p><img src="images/pr_review.jpg"></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/10/24/understanding-test-doubles/">Understanding Test Doubles</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-10-24T11:02:12-05:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2017</span></span> <span class='time'>11:02 am</span></time>
        
         | <a href="/blog/2017/10/24/understanding-test-doubles/#disqus_thread">Comments</a>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p>I refactored credit card payments on an application that uses the <code>ActiveMerchant</code> gem. I was not confident in the test, so, I re-wrote the tests to verify responses from Braintree. Once I verified I did not break anything with my refactor, I decided the best next step was to remove the interaction with Braintree and replace it with stubbed responses. I always forget when and how to use RSpec <code>allow</code>, <code>spy</code> and <code>double</code> methods. This post is meant to help reinforce my knowledge of the aforementioned methods.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">describe</span> <span class="no">CreditCardPayment</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">let!</span><span class="p">(</span><span class="ss">:payment</span><span class="p">)</span> <span class="p">{</span> <span class="n">build</span><span class="p">(</span><span class="ss">:credit_card_payment</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">describe</span> <span class="s1">&#39;#authorize&#39;</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">before</span> <span class="p">{</span> <span class="n">payment</span><span class="o">.</span><span class="n">authorize</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">it</span> <span class="s1">&#39;records the GatewayTransaction&#39;</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">transaction</span> <span class="o">=</span> <span class="no">GatewayTransaction</span><span class="o">.</span><span class="n">last</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">expect</span><span class="p">(</span><span class="n">transaction</span><span class="o">.</span><span class="n">success</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">eq</span> <span class="kp">true</span>
</span><span class='line'>      <span class="n">expect</span><span class="p">(</span><span class="n">transaction</span><span class="o">.</span><span class="n">amount</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">eq</span> <span class="n">amount</span>
</span><span class='line'>      <span class="n">expect</span><span class="p">(</span><span class="n">transaction</span><span class="o">.</span><span class="n">message</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">eq</span> <span class="s1">&#39;1000 Approved&#39;</span>
</span><span class='line'>      <span class="n">expect</span><span class="p">(</span><span class="n">transaction</span><span class="o">.</span><span class="n">response</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">be_present</span>
</span><span class='line'>      <span class="n">expect</span><span class="p">(</span><span class="n">transaction</span><span class="o">.</span><span class="n">service_fee</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">eq</span> <span class="n">service_fee</span><span class="o">[</span><span class="ss">:service_fee</span><span class="o">]</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Authorize is a wrapper around the payment gateway #authorize method which returns a response from Braintree. I should have confidence that when sending Braintree arguments that the<code>#authorize</code> expects, the response will be successful. This is interaction is what needs to be stubbed in order to not call the Braintree API in the test environment. The benefits of this approach are that the test will be faster and more resilient because there is no communication with an external service. The negatives of this approach is that the API can change.</p>

<p>Let&rsquo;s update the above codeblock to stub out the interaction with Braintree.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">describe</span> <span class="no">CreditCardPayment</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">let</span><span class="p">(</span><span class="ss">:gateway_double</span><span class="p">)</span> <span class="p">{</span> <span class="n">double</span><span class="p">(</span><span class="s1">&#39;ActiveMerchant::Billing::BraintreeGateway&#39;</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">let!</span><span class="p">(</span><span class="ss">:payment</span><span class="p">)</span> <span class="p">{</span> <span class="n">build</span><span class="p">(</span><span class="ss">:credit_card_payment</span><span class="p">,</span> <span class="ss">gateway</span><span class="p">:</span> <span class="n">gateway_double</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">before</span> <span class="p">{</span> <span class="n">payment</span><span class="o">.</span><span class="n">gateway</span> <span class="o">=</span> <span class="n">gateway_double</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">describe</span> <span class="s1">&#39;#authorize&#39;</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">it</span> <span class="s1">&#39;sends a #authorize request to Braintree&#39;</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">expect</span><span class="p">(</span><span class="n">gateway_double</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">receive</span><span class="p">(</span><span class="ss">:authorize</span><span class="p">)</span><span class="o">.</span><span class="n">exactly</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">times</span>
</span><span class='line'>        <span class="o">.</span><span class="n">with</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">payment</span><span class="o">.</span><span class="n">credit_card</span><span class="p">,</span> <span class="n">payment</span><span class="o">.</span><span class="n">credit_card_descriptor</span><span class="p">)</span>
</span><span class='line'>  <span class="o">.</span><span class="n">and_return</span><span class="p">(</span><span class="n">authorize_response_stub</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">payment</span><span class="o">.</span><span class="n">authorize</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">it</span> <span class="s1">&#39;creates a GatewayTransaction&#39;</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">expect</span> <span class="p">{</span> <span class="n">payment</span><span class="o">.</span><span class="n">authorize</span> <span class="p">}</span><span class="o">.</span><span class="n">to</span> <span class="n">change</span><span class="p">(</span><span class="no">GatewayTransaction</span><span class="p">,</span> <span class="ss">:count</span><span class="p">)</span><span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">authorize_response_stub</span>
</span><span class='line'>    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;response_from_braintree&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;yay&#39;</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>     <span class="no">ActiveMerchant</span><span class="o">::</span><span class="no">Billing</span><span class="o">::</span><span class="no">Response</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="kp">true</span><span class="p">,</span> <span class="s1">&#39;1000 Approved&#39;</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="p">{</span><span class="ss">authorization</span><span class="p">:</span> <span class="s1">&#39;3e4r5q&#39;</span><span class="p">})</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Notice that in the <code>it</code> block the expectation comes before the <code>#payment</code> method call. We could replace the <code>double</code> with a <code>spy</code>. The difference is a spy uses the <code>have_received</code> method. It is your preference to use either a <code>double</code> or a <code>spy</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="n">let</span><span class="p">(</span><span class="ss">:gateway_double</span><span class="p">)</span> <span class="p">{</span> <span class="n">spy</span><span class="p">(</span><span class="s1">&#39;ActiveMerchant::Billing::BraintreeGateway&#39;</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">let!</span><span class="p">(</span><span class="ss">:payment</span><span class="p">)</span> <span class="p">{</span> <span class="n">build</span><span class="p">(</span><span class="ss">:credit_card_payment</span><span class="p">,</span> <span class="ss">gateway</span><span class="p">:</span> <span class="n">gateway_double</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">before</span> <span class="p">{</span> <span class="n">payment</span><span class="o">.</span><span class="n">gateway</span> <span class="o">=</span> <span class="n">gateway_double</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">describe</span> <span class="s1">&#39;#authorize&#39;</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">it</span> <span class="s1">&#39;sends a #authorize request to Braintree&#39;</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">payment</span><span class="o">.</span><span class="n">authorize</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">expect</span><span class="p">(</span><span class="n">gateway_double</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">have_receive</span><span class="p">(</span><span class="ss">:authorize</span><span class="p">)</span><span class="o">.</span><span class="n">exactly</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">times</span>
</span><span class='line'>        <span class="o">.</span><span class="n">with</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">payment</span><span class="o">.</span><span class="n">credit_card</span><span class="p">,</span> <span class="n">payment</span><span class="o">.</span><span class="n">credit_card_descriptor</span><span class="p">)</span>
</span><span class='line'>  <span class="o">.</span><span class="n">and_return</span><span class="p">(</span><span class="n">authorize_response_stub</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">it</span> <span class="s1">&#39;creates a GatewayTransaction&#39;</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">expect</span> <span class="p">{</span> <span class="n">payment</span><span class="o">.</span><span class="n">authorize</span> <span class="p">}</span><span class="o">.</span><span class="n">to</span> <span class="n">change</span><span class="p">(</span><span class="no">GatewayTransaction</span><span class="p">,</span> <span class="ss">:count</span><span class="p">)</span><span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Helpful Links</h3>

<p><a href="https://relishapp.com/rspec/rspec-mocks/v/3-6/docs/basics">RSpec Mocks 3.6</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/08/11/python-first-thoughts/">Python, First Impressions</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-08-11T18:39:12-05:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>11</span><span class='date-suffix'>th</span>, <span class='date-year'>2017</span></span> <span class='time'>6:39 pm</span></time>
        
         | <a href="/blog/2017/08/11/python-first-thoughts/#disqus_thread">Comments</a>
        
        
      </p>
    
  </header>


  <div class="entry-content"><h4>Debugging</h4>

<ul>
<li>Write the following code to use an interactive debugger in Python.</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">import</span> <span class="nn">pdb</span>
</span><span class='line'><span class="n">pdb</span><span class="o">.</span><span class="n">set_trace</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<h4>Self</h4>

<ul>
<li>Passing a reference to <code>self</code> seems repetitive.</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span class='line'>    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Hello&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h4>Testing</h4>

<ul>
<li>You need to pass in the -s to <code>print</code> test output. I expected <code>print</code> to log output regardless.</li>
</ul>


<h4>Modules</h4>

<ul>
<li>You can conditionally implement different behavior when importing modules in Python.</li>
<li>Taken from <a href="https://stackoverflow.com/questions/419163/what-does-if-name-main-do">this</a> StackOverflow example.</li>
</ul>


<figure class='code'><figcaption><span>one.py</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">func</span><span class="p">():</span>
</span><span class='line'>    <span class="k">print</span><span class="p">(</span><span class="s">&quot;func() in one.py&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">print</span><span class="p">(</span><span class="s">&quot;top-level in one.py&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
</span><span class='line'>    <span class="k">print</span><span class="p">(</span><span class="s">&quot;one.py is being run directly&quot;</span><span class="p">)</span>
</span><span class='line'><span class="k">else</span><span class="p">:</span>
</span><span class='line'>    <span class="k">print</span><span class="p">(</span><span class="s">&quot;one.py is being imported into another module&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>two.py</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">import</span> <span class="nn">one</span>
</span><span class='line'>
</span><span class='line'><span class="k">print</span><span class="p">(</span><span class="s">&quot;top-level in two.py&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">one</span><span class="o">.</span><span class="n">func</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
</span><span class='line'>    <span class="k">print</span><span class="p">(</span><span class="s">&quot;two.py is being run directly&quot;</span><span class="p">)</span>
</span><span class='line'><span class="k">else</span><span class="p">:</span>
</span><span class='line'>    <span class="k">print</span><span class="p">(</span><span class="s">&quot;two.py is being imported into another module&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Running <code>python one.py</code> returns:
<code>
top-level in one.py
one.py is being run directly
</code></p>

<p>While running <code>python two.py</code> returns:
<code>
top-level in one.py
one.py is being imported into another module
top-level in two.py
func() in one.py
two.py is being run directly
</code></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/06/05/artificial-intelligence-nano-degree/">Artificial Intelligence Nano Degree</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-06-05T16:33:41-05:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>5</span><span class='date-suffix'>th</span>, <span class='date-year'>2017</span></span> <span class='time'>4:33 pm</span></time>
        
         | <a href="/blog/2017/06/05/artificial-intelligence-nano-degree/#disqus_thread">Comments</a>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p>I started the <a href="https://www.udacity.com/course/artificial-intelligence-nanodegree--nd889">Udacity</a> Artificial Intelligence Nano Degree last month.</p>

<h3>Project 1, Sudoku Solver</h3>

<ul>
<li><a href="http://norvig.com/sudoku.html">This</a> post helpful for building a sudoku solver.</li>
<li><a href="https://github.com/iacutone/AIND-Sudoku">My Solution</a></li>
</ul>


<p>The Sudoku Solver was a fun project. I enjoy learning by writing code to make tests pass, like Ruby Katas.</p>

<h3>Project 2, Isolation Game</h3>

<ul>
<li><a href="http://inst.eecs.berkeley.edu/~cs61b/fa14/ta-materials/apps/ab_tree_practice/">This</a> application is useful for visualizing alpha beta pruning.</li>
<li><a href="https://www.youtube.com/watch?v=STjW3eH0Cik">This</a> is a good introduction to the minimax function and alphabeta pruning.</li>
<li><a href="http://stpk.cs.rtu.lv/sites/all/files/stpk/materiali/mi/artificial%20intelligence%20a%20modern%20approach.pdf">Artificial Intelligence, A Modern Appoach</a> chapter 5 helped clarify ideas expressed in the Udacity videos.</li>
<li><a href="https://github.com/iacutone/AIND-Isolation">My Solution</a></li>
</ul>


<p>Creating an algo to play an Isolation Game is much more complicated than the first project and was very frustrating to build. Unlike the first project, there is barely a test framework to follow. You push your methods to a remote Udacity server which gives feedback about test failures. This development cycle is difficult to debug because you can neither use a debugger nor get <code>print</code> output. After the minimax and alphabeta functions pass the remote tests, things get interesting. You are asked to write custom heuristics in order to decide the best move for your player. I wish Udacity gave more hints as to game heuristics.</p>

<p>Writing a synopsis for a research paper is also required for the project. I chose to write about <a href="https://storage.googleapis.com/deepmind-media/alphago/AlphaGoNaturePaper.pdf">AlphaGo</a>. Due to my lack of knowledge reading math proofs, it took several attempts to understand the paper.</p>

<h3>Project 3, Implement a Planning Search</h3>

<p>Using planning problems—states, actions, and goals for planning algorithms. I enjoyed this unit of the course and it was interesting to study the development of Graph Plan algorithms since the 1970&rsquo;s.</p>

<ul>
<li><a href="https://www.youtube.com/watch?v=ySN5Wnu88nE">This</a> Computerphile video is a good reinforcement for A-Star search.</li>
<li><a href="http://aima.cs.berkeley.edu/2nd-ed/newchap11.pdf">Artificial Intelligence, A Modern Appoach</a> Chapter 11</li>
<li><a href="https://github.com/iacutone/AIND-Planning">My Solution</a></li>
</ul>


<h3>Project 4, Hidden Markov Models</h3>

<p>The objective of this unit is to create an algo that can correctly guess sign language words. Hidden Markov models are interesting and remind me of deep learning algos. They both seem to solve a similar problem set.</p>

<ul>
<li><a href="https://github.com/iacutone/AIND-Recognizer">My Solution</a></li>
</ul>


<h3>Overall Thoughts</h3>

<p>I am not sure this course is worth the $800 price. The class was interesting, but very time consuming. The benefits to taking the Udacity course over self learning on the internet is the Slack channel, forum and project feedback. I used the forum when I was stuck on a problem. I did not take advantage of the Slack channel. The project feedback was helpful. I will not be taking the next unit in the Artifical Intelligence Nano Degree. Instead, I am progressing through the <a href="http://course.fast.ai/">Fast AI</a> classes. I plan on writing a post after I finish the course.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/04/15/my-photo-storage-solution/">My Photo Storage Solution</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-04-15T09:58:55-05:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>15</span><span class='date-suffix'>th</span>, <span class='date-year'>2017</span></span> <span class='time'>9:58 am</span></time>
        
         | <a href="/blog/2017/04/15/my-photo-storage-solution/#disqus_thread">Comments</a>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p>I have been searching for a photo storage solution. My solution only involves two devices, a raspberry pi and an external hard drive. This post will explain how to set up your pi in order to automatically transfer RAW and JPG photos from an SD card to the hard drive connected to the pi. The scripts I used are available <a href="http://github.com/iacutone/scripts">here</a>.</p>

<p>I like this solution because the entire process is automatic. You are notified when the photo transfer has finished with an email. Also, for redundancy, I created a cron job that syncs all of the photos on my hard drive to Amazon photos. I use <a href="https://rclone.org/">this service</a> to sync the photos in the cloud.</p>

<h3>Steps</h3>

<h5>Mount the external hard drive to a folder on your pi.</h5>

<ul>
<li><code>sudo fdisk -l</code> take note of the Device, something like <code>/dev/sdb1</code></li>
<li>I like to mount the drive under the home dir, <code>sudo mount /dev/sdb1 ~/external_hd/</code></li>
<li>Run <code>lsblk -f</code>  to know here files are mounted</li>
</ul>


<h5>Create a <code>udev</code> rule</h5>

<ul>
<li><code>udev</code> rules live here: <code>/etc/udev/rules.d</code></li>
<li><code>cd /etc/udev/rules.d</code></li>
<li><code>touch 50-sdcard.rules</code></li>
<li><code>chmod +x 50-sdcard.rules</code></li>
<li><code>sudo fdisk -l</code> again to find the sd card device name, in this instance &lsquo;sda1&rsquo;</li>
<li><code>echo 'KERNEL=="sda1", ACTION=="add", RUN+="/home/pi/sdcard/sdcard_added.sh"' &lt; 50-sdcard.rules</code></li>
<li><code>tail -f /var/log/syslog</code> is extremely useful for debugging udev rules</li>
</ul>


<h5>Create an fstab privilege</h5>

<ul>
<li><code>vi /etc/fstab</code></li>
<li>Find device uuid with <code>blkid</code></li>
<li>Add <code>UUID=&lt;your-uuid&gt; /home/pi/SD_CARD auto rw,users,noauto      0       0</code></li>
<li>Uncomment out &lsquo;user_allow_other&rsquo; in <code>/etc/fuse.conf</code></li>
</ul>


<h5><code>rsync</code> when an sd card is added</h5>

<ul>
<li><code>touch /home/pi/sdcard/sdcard_added.sh</code></li>
<li><code>chmod +x /home/pi/sdcard/sdcard_added.sh</code></li>
<li>create the script</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/bin/bash</span>
</span><span class='line'>
</span><span class='line'><span class="nb">echo</span> <span class="s2">&quot;`date +%Y-%m-%d:%H:%M:%S` SD card inserted&quot;</span> &gt;&gt; /home/pi/sdcard/output.log
</span><span class='line'>mount /dev/sda1 /home/pi/SD_CARD
</span><span class='line'>rsync -av /home/pi/SD_CARD/DCIM/100MSDCF/ /home/pi/external_hd/raw_photos
</span></code></pre></td></tr></table></div></figure>


<h5>Sync photos to cloud provider</h5>

<ul>
<li>Set up cron job</li>
<li><code>sudo crontab -e</code></li>
<li><code>00 4 * * * /home/pi/sd_card/rclone_cron.sh</code>, this runs the cron job at 4 am, daily</li>
<li>create the bast script</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/bin/sh</span>
</span><span class='line'>/usr/sbin/rclone sync /home/pi/external_hd/raw_photos/ amazon:raw_photos --config /home/pi/.rclone.conf -v
</span></code></pre></td></tr></table></div></figure>


<h5>Send Email Notification</h5>

<ul>
<li>I used <a href="https://rianjs.net/2013/08/send-email-from-linux-server-using-gmail-and-ubuntu-two-factor-authentication">this post</a> to easily add email notifications when the rsync process completes</li>
</ul>


<h5>Tips Since Creating My Photo Process</h5>

<ul>
<li>I could not get the above code to work with Debian due to permission issues</li>
<li>It is better to identify from UUID instead of KERNEL for setting up udev rules, run <code>ls -l /dev/disk/by-uuid</code> to discover device UUID&rsquo;s</li>
</ul>


<h5>RClone</h5>

<ul>
<li>Amazon has blocked all thrid party applications from pushing to Amazon Drive. For more information see <a href="https://forum.rclone.org/t/rclone-has-been-banned-from-amazon-drive/2314">this</a></li>
<li>I am going to implement <a href="https://github.com/duplicati/duplicati">Duplicati</a> as a solution to sync my photos to Amazon Drive</li>
<li>Another potential solution is to continute to use rclone, but host the files on Google Drive</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/02/24/rspec-and-elastic-search/">RSpec and Elastic Search</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-02-24T11:39:11-05:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2017</span></span> <span class='time'>11:39 am</span></time>
        
         | <a href="/blog/2017/02/24/rspec-and-elastic-search/#disqus_thread">Comments</a>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p>I had a difficult time setting up  ElasticSearch on both RSpec (CircleCI) and Heroku. The ElasticSearch test cluster was not working on the CircleCI Docker image. Fortunately, one can configure the Circle environment to start with an ElasticSearch process. So, instead of using the test cluster, both my local testing environment and Circle environment use a real ElasticSearch process.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># ElasticSearch</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">before</span> <span class="ss">:all</span><span class="p">,</span> <span class="ss">elasticsearch</span><span class="p">:</span> <span class="kp">true</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">port</span> <span class="o">=</span> <span class="no">ENV</span><span class="o">[</span><span class="s1">&#39;CIRCLE_CI_ES_URL&#39;</span><span class="o">].</span><span class="n">present?</span> <span class="p">?</span> <span class="mi">9200</span> <span class="p">:</span> <span class="mi">9250</span>
</span><span class='line'>  <span class="no">Elasticsearch</span><span class="o">::</span><span class="no">Model</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="no">Elasticsearch</span><span class="o">::</span><span class="no">Client</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="ss">port</span><span class="p">:</span> <span class="n">port</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">before</span> <span class="ss">:each</span><span class="p">,</span> <span class="ss">elasticsearch</span><span class="p">:</span> <span class="kp">true</span> <span class="k">do</span>
</span><span class='line'>  <span class="no">Campaign</span><span class="o">.</span><span class="n">__elasticsearch__</span><span class="o">.</span><span class="n">create_index!</span><span class="p">(</span><span class="ss">force</span><span class="p">:</span> <span class="kp">true</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">after</span> <span class="ss">:each</span><span class="p">,</span> <span class="ss">elasticsearch</span><span class="p">:</span> <span class="kp">true</span> <span class="k">do</span>
</span><span class='line'>  <span class="no">Campaign</span><span class="o">.</span><span class="n">__elasticsearch__</span><span class="o">.</span><span class="n">delete_index!</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>When a test needs to use ElasticSearch:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">before</span> <span class="p">{</span> <span class="no">Campaign</span><span class="o">.</span><span class="n">__elasticsearch__</span><span class="o">.</span><span class="n">refresh_index!</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">describe</span> <span class="s1">&#39;#search&#39;</span><span class="p">,</span> <span class="ss">elasticsearch</span><span class="p">:</span> <span class="kp">true</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">expect</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">results</span><span class="p">)</span><span class="o">.</span><span class="n">to</span> <span class="n">be_present</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>I ran into issues using ElasticSearch on Heroku when creating an index. Heroku review apps are configurable by defining an <code>app.json</code>. In the json file, Heroku can spin up an ElasticSearch process.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="s2">&quot;scripts&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>  <span class="s2">&quot;postdeploy&quot;</span><span class="p">:</span> <span class="s2">&quot;bundle exec rake db:schema:load db:seed&quot;</span>
</span><span class='line'><span class="p">},</span>
</span><span class='line'><span class="s2">&quot;formation&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>  <span class="s2">&quot;web&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="s2">&quot;free&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;quantity&quot;</span><span class="p">:</span> <span class="mi">1</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="s2">&quot;elasticsearch&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="s2">&quot;free&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;quantity&quot;</span><span class="p">:</span> <span class="mi">1</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The process is running before any Ruby code is executed. The next step is to create the index using <code>postdeploy</code>. Before creating ActiveRecord objects in the <code>seed.rb</code> file, create an index with <code>Model.index(force: true)</code>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/10/31/vim/">Vim, Thoughts After Two Weeks</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-10-31T15:31:06-05:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>31</span><span class='date-suffix'>st</span>, <span class='date-year'>2016</span></span> <span class='time'>3:31 pm</span></time>
        
         | <a href="/blog/2016/10/31/vim/#disqus_thread">Comments</a>
        
        
      </p>
    
  </header>


  <div class="entry-content"><p>Purposefully, I began using Vim during a non-strenuous work week which helped manage frustration. I have been using solely Vim as a text editor for two weeks and have experienced improved efficienies over my previous text editor, Sublime.</p>

<h5>Improvments</h5>

<p>The ability to change between files quickly using the <a href="https://github.com/kien/ctrlp.vim">Ctrl-P</a> plugin is the biggest quality of life increase. Commands such as <code>/</code> and <code>?</code> make finding word matches in a file easy. Using RSpec with Vim is also great; I can change my code and re-run a single test without switching screens! There are many small wins with using Vim and they add up.</p>

<h5>Pain Points</h5>

<p>Adding new files does not work if the directory does not exist. The <a href="https://github.com/pbrisbin/vim-mkdir">mkdir</a> plugin solves this issue. Furthermore, commenting out code is a pain without <a href="https://github.com/tpope/vim-commentary">vim-commentary</a>. Checking my vimrc file into version controller has been helpful in debgging where breaking changes originate.</p>

<h5>More Resources</h5>

<p><a href="http://vimawesome.com">Vim Awesome</a></p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/2">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    
  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2018 -  -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | Themed with <a href="https://github.com/lucaslew/whitespace">Whitespace</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'iacutone';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>










  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
